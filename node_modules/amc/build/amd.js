module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}var a=n(1),o={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR",COLOR_0:"COLOR",COLOR_1:"COLOR_1",TEXCOORD:"TEXCOORD",TEXCOORD_0:"TEXCOORD",TEXCOORD_1:"TEXCOORD_1",TEXCOORD_2:"TEXCOORD_2",TANGENT:"TANGENT",JOINT:"JOINT",JOINTS_0:"JOINT",WEIGHT:"WEIGHT",WEIGHTS_0:"WEIGHT"},s=["POSITION","NORMAL","COLOR","TEXCOORD","TANGENT","JOINT","WEIGHT","OTHER","TEXCOORD_1","TEXCOORD_2","COLOR_1"],u={POSITION:0,NORMAL:1,COLOR:2,TEXCOORD:3,TANGENT:4,JOINT:5,WEIGHT:6,OTHER:7,TEXCOORD_1:8,TEXCOORD_2:9,COLOR_1:10},c={POSITION:"vertices",NORMAL:"normals",COLOR:"colors",TEXCOORD:"uvs",TEXCOORD_1:"uvs1",TEXCOORD_2:"uvs2",TANGENT:"tangents",JOINT:"skinIndices",WEIGHT:"skinWeights"},h={vertices:"POSITION",_normals:"NORMAL",colors:"COLOR",uvs:"TEXCOORD",uvs1:"TEXCOORD_1",uvs2:"TEXCOORD_2",_tangents:"TANGENT",skinIndices:"JOINT",skinWeights:"WEIGHT"},l={POSITION:3,NORMAL:3,COLOR:3,COLOR_1:3,TEXCOORD:2,TEXCOORD_1:2,TEXCOORD_2:2,TANGENT:4,JOINT:4,WEIGHT:4},f=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indices=t,this.mode=n,this.attrs=[],this.attrIndexMap={}}return i(e,null,[{key:"cp",value:function(e){return e}},{key:"minus",value:function(e,t){return e-t}},{key:"plus",value:function(e,t){return e+t}},{key:"pp",value:function(e,t,n,r){return r-t-n+e}},{key:"depp",value:function(e,t,n,r){return t+n-e+r}},{key:"ATTR",get:function(){return o}},{key:"ATTR_NAME_ID",get:function(){return u}}]),i(e,[{key:"getAttrLength",value:function(){return this.attrs[0].data.length/this.attrs[0].itemCount}},{key:"attrIdToName",value:function(e){return s[e]||"OTHER"}},{key:"addAttr",value:function(e,t,n){o[e]?(this.attrIndexMap[e]=this.attrs.length,n||(n=l[e])):n||(n=1),this.attrs.push({name:e,itemCount:n,data:t})}},{key:"getAttr",value:function(e){if(this.attrIndexMap[e])return this.attrs[this.attrIndexMap[e]];for(var t=this.attrs.length-1;t>=0;t--){var n=this.attrs[t];if(n.name===e)return n}}},{key:"cal",value:function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];this.attrs.forEach(function(r,a){for(var o=r.data,s=e.attrs[a].data,u=t*r.itemCount,c=r.itemCount-1;c>=0;c--)s[u+c]=n.apply(null,i.map(function(e){return o[e*r.itemCount+c]}))})}},{key:"quantize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.attrs.forEach(function(t){if("JOINT"!==t.name&&0!=e[t.name]){var n=a.encode(t.data,e[t.name]||12);t.quantizationBit=n.quantizationBit,t.min=n.min,t.max=n.max,t.data=n.data}})}},{key:"dequantize",value:function(){this.attrs.forEach(function(e){e.quantizationBit&&(e.data=a.decode(e.data,e.quantizationBit,e.min,e.max))})}},{key:"convertTypedArray",value:function(){!this.indices||this.indices instanceof Array||(this.indices=Array.from(this.indices)),this.attrs.forEach(function(e){e.data instanceof Array||e.data instanceof Float32Array||(e.data=Array.from(e.data))})}},{key:"clearEBAttrs",value:function(){delete this.clers,delete this.holes,delete this.handles}},{key:"convertToTypedArray",value:function(){this.indices instanceof Array&&(this.getAttrLength()>65535?this.indices=new Uint32Array(this.indices):this.indices=new Uint16Array(this.indices)),this.attrs.forEach(function(e){e.data instanceof Array&&(e.data=new Float32Array(e.data))})}},{key:"prepareToWorkerSend",value:function(){return this.clearEBAttrs(),this.convertToTypedArray(),this.getAllBuffers()}},{key:"clone",value:function(){var t=new e(Array.from(this.indices),this.mode);return Object.assign(t.attrIndexMap,this.attrIndexMap),t.attrs=this.attrs.map(function(e){var t=Object.assign({},e);return t.data=Array.from(t.data),t}),t}},{key:"cloneStruct",value:function(){var t=new e;return t.mode=this.mode,this.indices&&(t.indices=[]),Object.assign(t.attrIndexMap,this.attrIndexMap),t.attrs=this.attrs.map(function(e){var t=Object.assign({},e);return t.data=[],t}),t}},{key:"toHilo3dGeometry",value:function(e,t){var n=t||new e.Geometry;return this.indices&&(this.indices.BYTES_PER_ELEMENT?n.indices=new e.GeometryData(this.indices,1):this.getAttrLength()>65535?n.indices=new e.GeometryData(new Uint32Array(this.indices),1):n.indices=new e.GeometryData(new Uint16Array(this.indices),1)),this.attrs.forEach(function(t){var r=c[t.name];r&&(t.data.BYTES_PER_ELEMENT?n[r]=new e.GeometryData(t.data,t.itemCount):n[r]=new e.GeometryData(new Float32Array(t.data),t.itemCount))}),n}},{key:"getAllBuffers",value:function(){var e=[];return this.indices.BYTES_PER_ELEMENT&&e.push(this.indices.buffer),this.attrs.forEach(function(t){t.data&&t.data.BYTES_PER_ELEMENT&&e.push(t.data.buffer)}),e}}],[{key:"fromGLTFPrimitive",value:function(t){var n=new e(t.indices,t.mode),r=t.attributes,i=0;for(var a in r.POSITION&&(i=r.POSITION.length/3),r)if(o[a]){var s=l[o[a]];i&&(s=r[a].length/i),n.addAttr(o[a],r[a],s)}else console.warn("Dont support attribute",a);return n}},{key:"fromHilo3dGeometry",value:function(t){var n=new e(t.indices.data,t.mode);for(var r in h)t[r]&&n.addAttr(h[r],t[r].data,t[r].size);return n}}]),e}();e.exports=f},function(e,t){var n={};function r(e){return n[e]||(n[e]=Math.pow(2,e)-1),n[e]}e.exports={cal:function(e,t,n,i){var a=r(i),o=n-t;return Math.round((e-t)/o*a)},encode:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=e.length,i=r(t),a=1/0,o=-1/0,s=0;s<n;s++)a=Math.min(a,e[s]),o=Math.max(o,e[s]);var u=o-a||1,c=[];for(s=0;s<n;s++)c[s]=Math.round((e[s]-a)/u*i);return{min:a,max:o,quantizationBit:t,data:c}},encodeWithMinAndMax:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:8,o=e.length,s=r(a),u=i-n||1,c=0;c<o;c++)t[c]=Math.round((e[c]-n)/u*s);return t},decode:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,a=e.length,o=r(t),s=i-n,u=new Float32Array(a),c=0;c<a;c++)u[c]=n+s*(e[c]/o);return u},normalize:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=e.length,i=0;i<r;i+=n){for(var a=0,o=0;o<n;o++)a+=e[i+o]*e[i+o];a=Math.sqrt(a);for(o=0;o<n;o++)t[i+o]=e[i+o]/a}return t}}},function(e,t,n){e.exports=n(3)},function(e,t,n){var r=n(4);r.Geometry=n(0),e.exports=r},function(e,t,n){var r=n(0),i=n(5),a=n(7),o=n(8),s=n(9),u=[i],c=[a];function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e instanceof Uint8Array&&(t=e.byteOffset,e=e.buffer),function(e){return new u[e.type](e).decompress()}(function(e,t){var n=new Uint8Array(e,t,4);if(65!==n[0]||77!==n[1]||67!==n[2])throw new Error("The file is not AMC format!");var r=c[n[3]].read(e,t+4);return r.geometry.type=n[3],r.geometry}(e,t))}var l,f=null,d=null;function v(e,t){return!f&&s()?(f=new o({wasmURL:e,memPages:t}),d=f.init()):d||Promise.resolve()}function p(e,t,n){if(f||v(t,n),!f||!f.isReady)return h(e);try{return f.decompress(e)}catch(t){return console.warn("wasm decompress error",t),h(e)}}var y=null;function m(e){return e=e||"https://g.alicdn.com/hilo/amc/0.1.27/worker.js",y||(!1===l||"undefined"==typeof Worker?Promise.reject("dont support web worker"):y=/^(?:http|blob|data:|\/\/)/.test(e)?new Promise(function(t,n){var r=new XMLHttpRequest;r.addEventListener("load",function(){if("undefined"==typeof URL||"undefined"==typeof Blob)l=new Worker("data:application/javascript, ".concat(this.responseText));else{var e=URL.createObjectURL(new Blob([this.responseText]));l=new Worker(e)}l.onerror=function(e){console.log("web worker error",e),l=!1,n(e)},t(l)}),r.addEventListener("error",function(e){return n(e)}),r.open("get",e,!0),r.send()}):new Promise(function(t,n){(l=new Worker(e)).onerror=function(e){console.log("web worker init error",e),l=!1,n(e)},t(l)}))}var g=0;function O(e,t,n,i){return t=t&&s(),e=new Uint8Array(e),m(i).then(function(i){return new Promise(function(a,o){var s=g++,u=function(t){if(t.data.id===s)if(i.removeEventListener("message",u),u=null,t.data.data){var n=t.data.data;n.constructor=r,n.__proto__=r.prototype,a(n)}else a(h(e))};i.addEventListener("message",u),i.postMessage({id:s,data:e,useWASM:t,wasmURL:n},[e.buffer])})}).catch(function(r){return t?p(e,n):h(e)})}e.exports={initWASM:v,initWorker:m,decompress:function(e,t,n){var r=s();return!r||e.byteLength>1048576?O(e,r,t,n):r?Promise.resolve(p(e,t)):Promise.resolve(h(e))},decompressWithJS:h,decompressWithWASM:p,decompressWithWorker:O,destory:function(){l&&(l.terminate(),l=null,y=null),f&&(f=null,d=null)}}},function(e,t,n){function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=n(0),o=(n(1),n(6)),u=o.map,c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.geometry=t,this.faceCount=t.clers.length,this.clers=t.clers,this.holes=t.holes,this.handles=t.handles,this.createHandleMap(this.handles),this.vertexCount=t.getAttrLength(),this.noParallelogramPrediction=!!t.noParallelogramPrediction}var t,n,c;return t=e,(n=[{key:"nextCorner",value:function(e){return e<0?-1:e+(e%3==2?-2:1)}},{key:"prevCorner",value:function(e){return e<0?-1:e+(e%3?-1:2)}},{key:"createHandleMap",value:function(e){var t=this.handlesMap={};if(e)for(var n=e.length-1;n>=0;n-=2)t[e[n]]=e[n-1]}},{key:"mapBoundary",value:function(e){for(var t=this.indices,n=e.length,r=this.currentVertex,i=this.currentVertex-n+1,a=n-1;a>=0;a--)t[this.nextCorner(e[a])]=r,r=i,t[this.prevCorner(e[a])]=i++;this.currentVertex-=n}},{key:"mapHoleBoundary",value:function(e){for(var t=this.indices,n=e.length,r=this.currentVertex-n+1,i=r,a=n-1;a>=0;a--)t[this.nextCorner(e[a])]=r++,t[this.prevCorner(e[a])]=a?r:i;this.currentVertex-=n}},{key:"fixNegativeIndex",value:function(e){for(var t=e,n=this.indices;n[e]<0;){if(t===-n[-n[e]]||n[e]===n[-n[e]]){console.warn("dead loop bug!!"),n[s]=0;break}n[e]=n[-n[e]]}}},{key:"fixIndicesAndReadVertice",value:function(){for(var e,t=this.indices,n=this.handlesMap,r=this.clers,i=r.length,a=-1,s=[],u=0,c=0;u<i;u++,c+=3)-1===a?(this.fixNegativeIndex(c+1),this.fixNegativeIndex(c+2)):(t[c+1]=t[this.prevCorner(a)],t[c+2]=t[this.nextCorner(a)]),this.fixNegativeIndex(c),-1===a?(this.readVertex(t[c+2]),this.readVertex(t[c+1]),this.readVertex(t[c])):this.readVertex(t[c],a),a=c+1,(e=r[u])!==o.S||n[u]?e===o.E||e===o.F?a=s.pop():e===o.R&&(a=c+2):s.push(c+2),e===o.F&&(a=-1,delete this.lastReadVertexIndex),this._onDecompressFace(u,e)}},{key:"readVertex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(!this.readedVertexMap[e]&&(this.readedVertexMap[e]=1,!this.noParallelogramPrediction)){var n=this.indices,r=this.geometry;-1===t?void 0!==this.lastReadVertexIndex&&r.cal(r,e,a.plus,this.lastReadVertexIndex,e):r.cal(r,e,a.depp,n[t],n[this.prevCorner(t)],n[this.nextCorner(t)],e),this.lastReadVertexIndex=e}}},{key:"markCorner",value:function(e,t){var n=this.indices;void 0===n[this.nextCorner(e)]&&(n[this.nextCorner(e)]=-this.prevCorner(t[0])),void 0===n[this.prevCorner(e)]&&(n[this.prevCorner(e)]=-this.nextCorner(t[t.length-1]))}},{key:"onFaceC",value:function(e){var t=this.indices,n=3*this.currentFace,r=this.currentVertex--;t[n]=r;var i=e.pop();return t[this.nextCorner(i)]=r,t[this.prevCorner(i)]=-this.nextCorner(e[e.length-1]),i=e.shift(),t[this.prevCorner(i)]=r,t[this.nextCorner(i)]=-this.prevCorner(e[0]),e.push(n),e}},{key:"onFaceL",value:function(e){var t=3*this.currentFace;return this.markCorner(e.pop(),e),e.unshift(t+2),e.push(t),e}},{key:"onFaceF",value:function(e,t){return e&&this.mapBoundary(e),this.onFaceE(null,t)}},{key:"onFaceE",value:function(e,t){var n=3*this.currentFace;return e&&t.push(e),[n+2,n+1,n]}},{key:"onFaceR",value:function(e){var t=3*this.currentFace;return this.markCorner(e.pop(),e),e.push(t+1,t),e}},{key:"onHandleEnd",value:function(e,t,n){var r=this.indices,i=3*this.currentFace,a=this.handlesMap[this.currentFace],o=t.splice(0,e);return t.shift(),n.push(o),r[this.nextCorner(a)]=-(i+1),r[this.prevCorner(a)]=-this.nextCorner(o[o.length-1]),r[i]=-this.prevCorner(o[0]),t.push(i),t}},{key:"onHandleStart",value:function(e,t){for(var n,i=this.indices,a=3*this.currentFace,o=this.handlesMap[this.currentFace],s=t.length-1;s>=0;s--){var u=t[s].indexOf(o);if(u>=0){var c,h=(n=t.splice(s,1)[0]).splice(0,u);n.shift(),(c=n).push.apply(c,r(h));break}}return i[this.nextCorner(o)]=-(a+1),i[this.prevCorner(o)]=-this.nextCorner(n[n.length-1]),i[a]=-this.prevCorner(e[0]),(e=n.concat(e)).push(a),e}},{key:"onFaceS",value:function(e,t,n){var r=this.handlesMap,i=this.indices,a=3*this.currentFace;if(r[this.currentFace]){this.markCorner(e.pop(),e);var o=e.indexOf(r[this.currentFace]);e=o>=0?this.onHandleEnd(o,e,n):this.onHandleStart(e,n)}else{var s=e.pop();this.markCorner(s,e),i[a]=-this.nextCorner(s);var u=t.pop();this.markCorner(u.pop(),u),(e=u.concat(e)).push(a)}return e}},{key:"onFaceM",value:function(e,t,n){var r=this.indices,i=3*this.currentFace,a=e.splice(0,this.holes[this.currentHole--]);this.mapHoleBoundary(a);var o=r[this.prevCorner(a[0])];r[i]=o;var s=e.pop();return r[this.prevCorner(s)]=-this.nextCorner(e[e.length-1]),r[this.nextCorner(s)]=o,s=e.shift(),r[this.prevCorner(s)]=o,r[this.nextCorner(s)]=-this.prevCorner(e[0]),e.push(i),e}},{key:"decompress",value:function(){this.readedVertexMap=new Uint8Array(this.vertexCount);var e=this.faceCount,t=this.indices=new Array(3*e);this.currentFace=e-1,this.currentVertex=this.vertexCount-1,this.currentHole=this.holes.length-1;for(var n,r=this.clers,i=[],a=[];this.currentFace>=0;){var o="onFace"+u[r[this.currentFace]];this[o]?n=this[o](n,i,a):console.warn("has no ".concat(o)),this.currentFace--}return this.mapBoundary(n),this.fixIndicesAndReadVertice(this.indices),this.geometry.indices=t,this.geometry.dequantize(),this.geometry}},{key:"_onDecompressFace",value:function(e,t){this.onDecompressFace&&this.onDecompressFace(e,t)}}])&&i(t.prototype,n),c&&i(t,c),e}();e.exports=c},function(e,t){var n={C:0,R:1,L:2,S:3,E:4,M:5,F:6},r=[];for(var i in n)r[n[i]]=i;n.map=r,e.exports=n},function(e,t,n){var r=n(0);function i(e,t,n,r){return new e(t.slice(n,n+r*e.BYTES_PER_ELEMENT))}e.exports={read:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=new DataView(e),a=new r,o=function(e,t){var n={};return n.version=e.getUint8(t++),n.faceCount=e.getUint32(t,!0),t+=4,n.vertexCount=e.getUint32(t,!0),t+=4,n.attrCount=e.getUint8(t++),n.noParallelogramPrediction=e.getUint8(t++),n.holesCount=e.getUint16(t,!0),t+=2,n.handlesCount=e.getUint16(t,!0),t+=2,n.headerBytes=15,n}(n,t);return t+=o.headerBytes,a.mode="CLERS",t=function(e,t,n,r){return r.holesCount?(e.holes=i(Uint16Array,t.buffer,n,r.holesCount),n+2*r.holesCount):(e.holes=[],n)}(a,n,t,o),t=function(e,t,n,r){return r.handlesCount?(e.handles=i(Uint32Array,t.buffer,n,2*r.handlesCount),n+8*r.handlesCount):(e.handles=[],n)}(a,n,t,o),t=function(e,t,n,r){return e.clers=new Uint8Array(t.buffer,n,r.faceCount),n+r.faceCount}(a,n,t,o),t=function(e,t,n,r){for(var a=0;a<r.attrCount;a++){var o={},s=t.getUint16(n,!0);n+=2,o.name=e.attrIdToName(s),o.itemCount=t.getUint8(n++),o.quantizationBit=t.getUint8(n++),o.min=t.getFloat32(n,!0),n+=4,o.max=t.getFloat32(n,!0),n+=4,o.data=i(Int16Array,t.buffer,n,o.itemCount*r.vertexCount),n+=o.itemCount*r.vertexCount*2,e.attrs.push(o)}return n}(a,n,t,o),{header:o,geometry:a,offset:t}}}},function(e,t,n){function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=n(0),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wasmURL=t.wasmURL||"https://ossgw.alicdn.com/tmall-c3/tmx/70b8d82ccf33e97a124e54c2d6a3e0c7.wasm",this.memPages=t.memPages||256,this.memPages<256&&(this.memPages=256),this.isReady=!1}var t,n,s;return t=e,(n=[{key:"initASMJS",value:function(){this.isReady=!0,this.dv=new DataView(HEAP8.buffer),this.heap8=HEAP8,this.ins={exports:{__Z7AMCinitj:Module.__Z7AMCinitj,__Z12AMDecompressv:Module.__Z12AMDecompressv}}}},{key:"init",value:function(){var e=this,t=this.memory=new WebAssembly.Memory({initial:this.memPages});this.dv=new DataView(t.buffer);var n=this.heap8=new Uint8Array(t.buffer),r={global:{NaN:5,Infinity:6},env:{memoryBase:0,memory:t,_malloc:function(){return 2097152},_memset:function(e,t,r){return n.fill(t,e,e+r),e},_printf:function(e,t){for(var r=e;n[r];)r++;var a=String.fromCharCode.apply(String,i(n.slice(e,r))),o=0;a=a.replace(/%([duf])/g,function(e,n){return"d"===n||"u"===n?dv.getInt32(t+4*o++,!0):"f"===n?dv.getFloat32(t+4*o++,!0):void 0}),console.log(a)}}};return fetch(this.wasmURL).then(function(e){return e.arrayBuffer()}).then(function(e){return WebAssembly.instantiate(e,r)}).then(function(t){e.module=t,e.ins=t.instance,e.isReady=!0}).catch(function(e){return console.log("wasm load error, use js ver")})}},{key:"getDataAddr",value:function(e){return this.ins.exports.__Z7AMCinitj(e)}},{key:"decompress",value:function(e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));var t=this.dv,n=this.heap8,i=this.getDataAddr(e.length);n.set(e,i);var a=this.ins.exports.__Z12AMDecompressv();if(a<=0)throw console.error("decompression error code: "+a),new Error("decompression error code: "+a);for(var s=t.getUint32(a,!0),u=t.getUint32(a+4,!0),c=t.getUint32(a+8,!0),h=t.getUint32(a+12,!0),l=[],f=0;f<h;f++){var d=a+16+12*f;l.push([t.getUint32(d,!0),t.getUint32(d+4,!0),t.getUint32(d+8,!0)])}var v=new Uint32Array(t.buffer,u,3*s);v=c>65536?new Uint32Array(v):new Uint16Array(v);var p=new o(v);return l.forEach(function(e){var n=r(e,3),i=n[0],a=n[1],o=n[2],s=new Float32Array(t.buffer.slice(o,o+c*a*4));p.addAttr(p.attrIdToName(i),s,a)}),p}}])&&a(t.prototype,n),s&&a(t,s),e}();e.exports=s},function(e,t){function n(){if("undefined"==typeof WebAssembly||"undefined"==typeof fetch||function(){if(!/iPad|iPhone|iPod/i.test(navigator.userAgent))return!1;if(/OS (\d+)_(\d+)_?(\d+)?/i.test(navigator.userAgent)){var e=Number(RegExp.$1),t=Number(RegExp.$2);if(11===e&&t>=3||e>11)return!1}return!0}())return!1;try{var e=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),t=new WebAssembly.Module(e);return 0!==new WebAssembly.Instance(t,{}).exports.test(4)}catch(e){return console.log("err while check WebAssembly",e),!1}}var r;e.exports=function(){return void 0===r&&(r=n()),r}}]);